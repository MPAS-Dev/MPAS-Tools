

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Testing Changes to mpas_tools &mdash; mpas_tools stable documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Building the Documentation" href="building_docs.html" />
    <link rel="prev" title="Making Changes to mpas_tools" href="making_changes.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> mpas_tools
          

          
          </a>

          
            
            
              <div class="version">
                stable
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User's Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="mesh_creation.html">Mesh Creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="mesh_conversion.html">Mesh Conversion</a></li>
<li class="toctree-l1"><a class="reference internal" href="interpolation.html">Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="cime.html">CIME Constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="transects.html">Transects</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualization</a></li>
</ul>
<p class="caption"><span class="caption-text">Ocean Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ocean/mesh_creation.html">Ocean Mesh Creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="ocean/coastal_tools.html">Coastal Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="ocean/coastline_alteration.html">Coastline Alteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="ocean/moc.html">Meridional Overturning Circulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="ocean/depth.html">Adding a Depth Coordinate</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer's Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="making_changes.html">Making Changes to mpas_tools</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Testing Changes to mpas_tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#testing-from-the-git-repo">Testing from the git repo</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing-the-conda-package">Testing the conda package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#updating-the-version">Updating the Version</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-the-package">Building the package</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-the-package">Installing the package</a></li>
<li class="toctree-l3"><a class="reference internal" href="#removing-the-test-environment">Removing the test environment</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="building_docs.html">Building the Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Authors</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Main Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html#contributors">Contributors</a></li>
</ul>
<p class="caption"><span class="caption-text">Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="versions.html">Versions</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">mpas_tools</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Testing Changes to mpas_tools</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/testing_changes.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="testing-changes-to-mpas-tools">
<span id="dev-testing-changes"></span><h1>Testing Changes to mpas_tools<a class="headerlink" href="#testing-changes-to-mpas-tools" title="Permalink to this headline">¶</a></h1>
<p>There are a few different ways to test the <code class="docutils literal notranslate"><span class="pre">mpas_tools</span></code> package.  Typically,
the quickest turn-around between making changes and seeing their results are
going to be seen if you can test the code straight out of the git repo.  This
approach works for calling functions from the package within a python script
but doesn’t give you easy access to the “entry points”(see
<a class="reference internal" href="making_changes.html#dev-making-changes"><span class="std std-ref">Making Changes to mpas_tools</span></a>). To more fully test the package, you will need to
build the package locally, install it into a new conda environment, and test
your code within that environment.</p>
<div class="section" id="testing-from-the-git-repo">
<h2>Testing from the git repo<a class="headerlink" href="#testing-from-the-git-repo" title="Permalink to this headline">¶</a></h2>
<p>If you are testing a simple python script that accesses <code class="docutils literal notranslate"><span class="pre">mpas_tools</span></code>, you can
make a symlink in the same directory as your python script to <code class="docutils literal notranslate"><span class="pre">mpas_tools</span></code>
within <code class="docutils literal notranslate"><span class="pre">conda_package</span></code>.  Python should search the local path before looking
elsewhere so this should work even if a previous version <code class="docutils literal notranslate"><span class="pre">mpas_tools</span></code> is
already installed in the conda environment you are using.</p>
</div>
<div class="section" id="testing-the-conda-package">
<h2>Testing the conda package<a class="headerlink" href="#testing-the-conda-package" title="Permalink to this headline">¶</a></h2>
<div class="section" id="updating-the-version">
<h3>Updating the Version<a class="headerlink" href="#updating-the-version" title="Permalink to this headline">¶</a></h3>
<p>As part of your testing, you should update the version of <code class="docutils literal notranslate"><span class="pre">mpas_tools</span></code>.  This
should be done both in <code class="docutils literal notranslate"><span class="pre">conda_package/mpas_tools/__init__.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">__version_info__</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">vi</span><span class="p">)</span> <span class="k">for</span> <span class="n">vi</span> <span class="ow">in</span> <span class="n">__version_info__</span><span class="p">)</span>
</pre></div>
</div>
<p>Increment <code class="docutils literal notranslate"><span class="pre">__version_info__</span></code> (major, minor or micro version, depending on
what makes sense).</p>
<p>The version in the conda recipe (<code class="docutils literal notranslate"><span class="pre">conda_package/recipe/meta.yaml</span></code>) needs to
match:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="nb">set</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;mpas_tools&quot;</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="nb">set</span> <span class="n">version</span> <span class="o">=</span> <span class="s2">&quot;0.0.11&quot;</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<p>It is also a good idea to add the new version to the <a class="reference internal" href="versions.html#versions"><span class="std std-ref">Versions</span></a>.  The new
links won’t be valid until a new release is made and Azure Pipelines has
generated the associated documentation.  Eventually, it should be possible to
do this automatically but that has not yet been implemented.</p>
</div>
<div class="section" id="building-the-package">
<h3>Building the package<a class="headerlink" href="#building-the-package" title="Permalink to this headline">¶</a></h3>
<p>To build the conda package, you will need to install conda-build into your base
conda environment.  (Basic instructions on how to install Miniconda or Anaconda
are beyond the scope of this documentation.)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda config --add channels conda-forge
$ conda config --set channel_priority strict
$ conda install -n base conda-build
</pre></div>
</div>
<p>To build the package, make sure you are in the base of the repo and run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ rm -rf ~/miniconda3/conda-bld
$ conda build -m conda_package/ci/linux_python3.8.yaml conda_package/recipe
</pre></div>
</div>
<p>The first is to make sure you don’t have existing packages already built that
would get used in your building and testing instead of the versions from
<code class="docutils literal notranslate"><span class="pre">conda-forge</span></code>.  If your conda setup is installed somewhere other than
<code class="docutils literal notranslate"><span class="pre">~/miniconda3</span></code>, use the appropriate path.  If you would like to build for
<code class="docutils literal notranslate"><span class="pre">osx</span></code> instead of <code class="docutils literal notranslate"><span class="pre">linux</span></code> or for python <code class="docutils literal notranslate"><span class="pre">3.6</span></code> or <code class="docutils literal notranslate"><span class="pre">3.7</span></code>, point
<code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">build</span></code> to the appropriate YAML file.</p>
</div>
<div class="section" id="installing-the-package">
<h3>Installing the package<a class="headerlink" href="#installing-the-package" title="Permalink to this headline">¶</a></h3>
<p>To make a new test environment to try out scripts, other python packages or
other workflows that use the tools, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda create -n test_mpas_tools --use-local python=3.8 mpas_tools
</pre></div>
</div>
<p>You can name the environment whatever if useful to you.  Activate the
environment with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda activate test_mpas_tools
</pre></div>
</div>
<p>You should now find that <code class="docutils literal notranslate"><span class="pre">mpas_tools</span></code> can be imported in python codes and the
various scripts and entry points are available in the path.</p>
</div>
<div class="section" id="removing-the-test-environment">
<h3>Removing the test environment<a class="headerlink" href="#removing-the-test-environment" title="Permalink to this headline">¶</a></h3>
<p>If you’re done with testing, you can remove the test environment</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda deactivate
$ conda remove --all -n test_mpas_tools
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="building_docs.html" class="btn btn-neutral float-right" title="Building the Documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="making_changes.html" class="btn btn-neutral float-left" title="Making Changes to mpas_tools" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright This software is open source software available under the BSD-3license. Copyright (c) 2019 Triad National Security, LLC. All rights reserved. Copyright (c) 2019 Lawrence Livermore National Security, LLC. All rights reserved. Copyright (c) 2019 UT-Battelle, LLC. All rights reserved..

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>