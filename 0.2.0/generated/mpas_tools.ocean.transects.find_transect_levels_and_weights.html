

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>mpas_tools.ocean.transects.find_transect_levels_and_weights &mdash; mpas_tools 0.2.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="mpas_tools.ocean.transects.interp_mpas_to_transect_triangles" href="mpas_tools.ocean.transects.interp_mpas_to_transect_triangles.html" />
    <link rel="prev" title="mpas_tools.ocean.inject_preserve_floodplain.inject_preserve_floodplain" href="mpas_tools.ocean.inject_preserve_floodplain.inject_preserve_floodplain.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> mpas_tools
          

          
          </a>

          
            
            
              <div class="version">
                0.2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User's Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../mesh_creation.html">Mesh Creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mesh_conversion.html">Mesh Conversion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interpolation.html">Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cime.html">CIME Constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualization.html">Visualization</a></li>
</ul>
<p class="caption"><span class="caption-text">Ocean Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ocean/mesh_creation.html">Ocean Mesh Creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ocean/coastal_tools.html">Coastal Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ocean/coastline_alteration.html">Coastline Alteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ocean/moc.html">Meridional Overturning Circulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ocean/depth.html">Adding a Depth Coordinate</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer's Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../making_changes.html">Making Changes to mpas_tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing_changes.html">Testing Changes to mpas_tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../building_docs.html">Building the Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api.html#mpas-mesh-tools">MPAS mesh tools</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../api.html#ocean-tools">Ocean Tools</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.coastline_alteration.html">mpas_tools.ocean.coastline_alteration</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.coastline_alteration.add_critical_land_blockages.html">mpas_tools.ocean.coastline_alteration.add_critical_land_blockages</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.coastline_alteration.widen_transect_edge_masks.html">mpas_tools.ocean.coastline_alteration.widen_transect_edge_masks</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.coastline_alteration.add_land_locked_cells_to_mask.html">mpas_tools.ocean.coastline_alteration.add_land_locked_cells_to_mask</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.moc.html">mpas_tools.ocean.moc</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.moc.make_moc_basins_and_transects.html">mpas_tools.ocean.moc.make_moc_basins_and_transects</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.moc.add_moc_southern_boundary_transects.html">mpas_tools.ocean.moc.add_moc_southern_boundary_transects</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.build_mesh.html">mpas_tools.ocean.build_mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.build_mesh.build_spherical_mesh.html">mpas_tools.ocean.build_mesh.build_spherical_mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.build_mesh.build_planar_mesh.html">mpas_tools.ocean.build_mesh.build_planar_mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.coastal_tools.html">mpas_tools.ocean.coastal_tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.coastal_tools.coastal_refined_mesh.html">mpas_tools.ocean.coastal_tools.coastal_refined_mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.coastal_tools.create_background_mesh.html">mpas_tools.ocean.coastal_tools.create_background_mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.coastal_tools.extract_coastlines.html">mpas_tools.ocean.coastal_tools.extract_coastlines</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.coastal_tools.distance_to_coast.html">mpas_tools.ocean.coastal_tools.distance_to_coast</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.coastal_tools.compute_cell_width.html">mpas_tools.ocean.coastal_tools.compute_cell_width</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.coastal_tools.save_matfile.html">mpas_tools.ocean.coastal_tools.save_matfile</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.coastal_tools.CPP_projection.html">mpas_tools.ocean.coastal_tools.CPP_projection</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.coastal_tools.smooth_coastline.html">mpas_tools.ocean.coastal_tools.smooth_coastline</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.coastal_tools.get_data_inside_box.html">mpas_tools.ocean.coastal_tools.get_data_inside_box</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.coastal_tools.get_indices_inside_quad.html">mpas_tools.ocean.coastal_tools.get_indices_inside_quad</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.coastal_tools.get_convex_hull_coordinates.html">mpas_tools.ocean.coastal_tools.get_convex_hull_coordinates</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.coastal_tools.plot_coarse_coast.html">mpas_tools.ocean.coastal_tools.plot_coarse_coast</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.coastal_tools.plot_region_box.html">mpas_tools.ocean.coastal_tools.plot_region_box</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.depth.add_depth.html">mpas_tools.ocean.depth.add_depth</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.depth.add_zmid.html">mpas_tools.ocean.depth.add_zmid</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.depth.write_time_varying_zmid.html">mpas_tools.ocean.depth.write_time_varying_zmid</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.depth.compute_depth.html">mpas_tools.ocean.depth.compute_depth</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.depth.compute_zmid.html">mpas_tools.ocean.depth.compute_zmid</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.inject_bathymetry.inject_bathymetry.html">mpas_tools.ocean.inject_bathymetry.inject_bathymetry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.inject_meshDensity.inject_meshDensity_from_file.html">mpas_tools.ocean.inject_meshDensity.inject_meshDensity_from_file</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.inject_meshDensity.inject_spherical_meshDensity.html">mpas_tools.ocean.inject_meshDensity.inject_spherical_meshDensity</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.inject_meshDensity.inject_planar_meshDensity.html">mpas_tools.ocean.inject_meshDensity.inject_planar_meshDensity</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.inject_preserve_floodplain.inject_preserve_floodplain.html">mpas_tools.ocean.inject_preserve_floodplain.inject_preserve_floodplain</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">mpas_tools.ocean.transects.find_transect_levels_and_weights</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.transects.interp_mpas_to_transect_triangles.html">mpas_tools.ocean.transects.interp_mpas_to_transect_triangles</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.transects.interp_mpas_to_transect_triangle_nodes.html">mpas_tools.ocean.transects.interp_mpas_to_transect_triangle_nodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.transects.interp_transect_grid_to_transect_triangle_nodes.html">mpas_tools.ocean.transects.interp_transect_grid_to_transect_triangle_nodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="mpas_tools.ocean.transects.get_outline_segments.html">mpas_tools.ocean.transects.get_outline_segments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#visualization">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#tests">Tests</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Authors</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Main Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html#contributors">Contributors</a></li>
</ul>
<p class="caption"><span class="caption-text">Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../versions.html">Versions</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">mpas_tools</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../api.html">API reference</a> &raquo;</li>
        
      <li>mpas_tools.ocean.transects.find_transect_levels_and_weights</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/generated/mpas_tools.ocean.transects.find_transect_levels_and_weights.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="mpas-tools-ocean-transects-find-transect-levels-and-weights">
<h1>mpas_tools.ocean.transects.find_transect_levels_and_weights<a class="headerlink" href="#mpas-tools-ocean-transects-find-transect-levels-and-weights" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="mpas_tools.ocean.transects.find_transect_levels_and_weights">
<code class="sig-prename descclassname">mpas_tools.ocean.transects.</code><code class="sig-name descname">find_transect_levels_and_weights</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dsTransect</span></em>, <em class="sig-param"><span class="n">layerThickness</span></em>, <em class="sig-param"><span class="n">bottomDepth</span></em>, <em class="sig-param"><span class="n">maxLevelCell</span></em>, <em class="sig-param"><span class="n">zTransect</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mpas_tools/ocean/transects.html#find_transect_levels_and_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mpas_tools.ocean.transects.find_transect_levels_and_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a vertical coordinate for a transect produced by
<code class="docutils literal notranslate"><span class="pre">mpas_tools.viz.transects.find_transect_cells_and_weights()</span></code>, then break
each resulting quadrilateral into 2 triangles that can later be visualized
with functions like <code class="docutils literal notranslate"><span class="pre">tripcolor</span></code> and <code class="docutils literal notranslate"><span class="pre">tricontourf</span></code>.  Also, compute
interpolation weights such that observations at points on the original
transect and with vertical coordinate <code class="docutils literal notranslate"><span class="pre">transectZ</span></code> can be bilinearly
interpolated to the nodes of the transect.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dsTransect</strong> (<em>xarray.Dataset</em>) – A dataset that defines nodes of the transect, the results of calling
<code class="docutils literal notranslate"><span class="pre">find_transect_cells_and_weights()</span></code></p></li>
<li><p><strong>layerThickness</strong> (<em>xarray.DataArray</em>) – layer thicknesses on the MPAS mesh</p></li>
<li><p><strong>bottomDepth</strong> (<em>xarray.DataArray</em>) – the (positive down) depth of the seafloor on the MPAS mesh</p></li>
<li><p><strong>maxLevelCell</strong> (<em>xarray.DataArray</em>) – the vertical zero-based index of the bathymetry on the MPAS mesh</p></li>
<li><p><strong>zTransect</strong> (<em>xarray.DataArray, optional</em>) – the z coordinate of the transect (1D or 2D).  If 2D, it must have the
same along-transect dimension as the lon and lat passed to
<code class="docutils literal notranslate"><span class="pre">find_transect_cells_and_weights()</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>dsTransectTriangles</strong> (<em>xarray.Dataset</em>) – A dataset that contains nodes and triangles that make up a 2D transect.
For convenience in visualization, the quadrilaterals of each cell making
up the transect have been divided into an upper and lower triangle.  The
nodes of the triangles are completely independent of one another,
allowing for potential jumps in fields values between nodes of different
triangles that are at the same location.  This is convenient, for
example, when visualizing data with constant values within each MPAS
cell.</p>
<p>There are <code class="docutils literal notranslate"><span class="pre">nTransectTriangles</span> <span class="pre">=</span> <span class="pre">2*nTransectCells</span></code> triangles, each with
<code class="docutils literal notranslate"><span class="pre">nTriangleNodes</span> <span class="pre">=</span> <span class="pre">3</span></code> nodes, where <code class="docutils literal notranslate"><span class="pre">nTransectCells</span></code> is the number of
valid transect cells (quadrilaterals) that are above the MPAS-Ocean
bathymetry.</p>
<p>In addition to the variables and coordinates in <code class="docutils literal notranslate"><span class="pre">dsTransect</span></code>, the
output dataset contains:</p>
<blockquote>
<div><ul class="simple">
<li><p>nodeHorizBoundsIndices: which of the <code class="docutils literal notranslate"><span class="pre">nHorizBounds</span> <span class="pre">=</span> <span class="pre">2</span></code>
bounds of a horizontal transect segment a given node is on</p></li>
<li><p>segmentIndices: the transect segment of a given triangle</p></li>
<li><p>cellIndices: the MPAS-Ocean cell of a given triangle</p></li>
<li><p>levelIndices: the MPAS-Ocean vertical level of a given triangle</p></li>
<li><p>zTransectNode: the vertical height of each triangle node</p></li>
<li><p>ssh, zSeaFloor: the sea-surface height and sea-floor height at
each node of each transect segment</p></li>
<li><p>interpCellIndices, interpLevelIndices: the MPAS-Ocean cells and
levels from which the value at a given triangle node are
interpolated.  This can involve up to <code class="docutils literal notranslate"><span class="pre">nWeights</span> <span class="pre">=</span> <span class="pre">12</span></code> different
cells and levels.</p></li>
<li><p>interpCellWeights: the weight to multiply each field value by
to perform interpolation to a triangle node.</p></li>
<li><p>transectInterpVertIndices, transectInterpVertWeights - if
<code class="docutils literal notranslate"><span class="pre">zTransect</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, vertical indices and weights for
interpolating from the original transect grid to MPAS-Ocean
transect nodes.</p></li>
</ul>
</div></blockquote>
<p>Interpolation of a DataArray from MPAS cells and levels to transect
triangle nodes can be performed with
<code class="docutils literal notranslate"><span class="pre">interp_mpas_to_transect_triangle_nodes()</span></code>.  Similarly, interpolation of a
DataArray (e.g. an observation) from the original transect grid to
transect triangle nodes can be performed with
<code class="docutils literal notranslate"><span class="pre">interp_transect_grid_to_transect_triangle_nodes()</span></code></p>
<p>To visualize constant values on MPAS cells, a field can be sampled
at indices <code class="docutils literal notranslate"><span class="pre">nCells=cellIndices</span></code> and <code class="docutils literal notranslate"><span class="pre">nVertLevels=levelIndices</span></code>.
If a smoother visualization is desired, bilinear interpolation can be
performed by first sampling the field at indices
<code class="docutils literal notranslate"><span class="pre">nCells=interpCellIndices</span></code> and <code class="docutils literal notranslate"><span class="pre">nVertLevels=interpLevelIndices</span></code> and
then multiplying by <code class="docutils literal notranslate"><span class="pre">interpCellWeights</span></code> and summing over
<code class="docutils literal notranslate"><span class="pre">nWeights</span></code>.</p>
</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="mpas_tools.ocean.transects.interp_mpas_to_transect_triangles.html" class="btn btn-neutral float-right" title="mpas_tools.ocean.transects.interp_mpas_to_transect_triangles" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="mpas_tools.ocean.inject_preserve_floodplain.inject_preserve_floodplain.html" class="btn btn-neutral float-left" title="mpas_tools.ocean.inject_preserve_floodplain.inject_preserve_floodplain" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright This software is open source software available under the BSD-3license. Copyright (c) 2019 Triad National Security, LLC. All rights reserved. Copyright (c) 2019 Lawrence Livermore National Security, LLC. All rights reserved. Copyright (c) 2019 UT-Battelle, LLC. All rights reserved..

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>